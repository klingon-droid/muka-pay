---
// import Welcome from '../components/Welcome.astro';
import Layout from "../layouts/Layout.astro";
import Wallet2 from "../components/Wallet2.vue";
---

<Layout>
  <head>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&family=Doto:wght@600&display=swap" rel="stylesheet" />
  </head>

  <script>
    import { Buffer } from "buffer";

    if (typeof window !== "undefined") {
      window.Buffer = Buffer;
    }

    // check local storage for mukapay-consent
    if (!localStorage.getItem("mukapay-consent")) {
      window.location.href = "/consent";
    }
  </script>

  <div id="loading-container" class="fixed inset-0 flex items-center justify-center bg-white z-50">
    <div class="flex flex-col items-center space-y-8">

		<img src="/logo.png" alt="logo" class="w-[10rem] h-[10rem]">

      <div class="flex items-center space-x-2">
		<div class="w-8 h-8 border-4 border-black border-t-transparent rounded-full animate-spin"></div>
	  </div>
    </div>
  </div>

  <Wallet2 client:only="vue" id="wallet-component" />

  <script>
    // Function to hide loading screen
    function hideLoadingScreen() {
      const loadingContainer = document.getElementById('loading-container');
      if (loadingContainer) {
        loadingContainer.style.transition = 'opacity 0.3s ease-out';
        loadingContainer.style.opacity = '0';
        
        setTimeout(() => {
          loadingContainer.remove();
        }, 300);
      }
    }

    // Listen for the Vue component mounted event
    document.addEventListener('vue-mounted', hideLoadingScreen);

    // Fallback: hide loading screen after 5 seconds
    setTimeout(hideLoadingScreen, 5000);
  </script>
</Layout>

<style>
  #loading-container {
    transition: opacity 0.3s ease-out;
  }
</style>
